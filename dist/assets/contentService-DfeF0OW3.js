import{s as n}from"./supabase-C7PnJWqa.js";class i{static async getAllContent(){console.log("Fetching content from database...",{supabaseUrl:"configured",supabaseKey:"configured"});const{data:e,error:t}=await n.from("content_items").select("*").eq("is_published",!0).order("published_at",{ascending:!1});if(t)throw console.error("Supabase error fetching content:",{message:t.message,details:t.details,hint:t.hint,code:t.code}),t;if(console.log("Fetched content items:",(e==null?void 0:e.length)||0,"items"),!e||e.length===0)throw console.warn("No content items found in database"),new Error("No content found in database");return e}static async getFeaturedContent(){const{data:e,error:t}=await n.from("content_items").select("*").eq("is_published",!0).eq("is_featured",!0).order("published_at",{ascending:!1});if(t)throw console.error("Error fetching featured content:",t),t;return e}static async getContentByType(e){const{data:t,error:r}=await n.from("content_items").select("*").eq("is_published",!0).eq("content_type",e).order("published_at",{ascending:!1});if(r)throw console.error("Error fetching content by type:",r),r;return t}static async getContentByCategory(e){const{data:t,error:r}=await n.from("content_items").select("*").eq("is_published",!0).eq("category",e).order("published_at",{ascending:!1});if(r)throw console.error("Error fetching content by category:",r),r;return t}static async getContentBySlug(e){const{data:t,error:r}=await n.from("content_items").select("*").eq("slug",e).eq("is_published",!0).single();if(r)throw console.error("Error fetching content by slug:",r),r;return t}static async searchContent(e){const{data:t,error:r}=await n.from("content_items").select("*").eq("is_published",!0).or(`title.ilike.%${e}%,excerpt.ilike.%${e}%,content.ilike.%${e}%`).order("published_at",{ascending:!1});if(r)throw console.error("Error searching content:",r),r;return t}static async getRelatedContent(e,t=3){const{data:r,error:o}=await n.from("content_items").select("*").eq("is_published",!0).neq("id",e.id).or(`category.eq.${e.category},content_type.eq.${e.content_type}`).order("published_at",{ascending:!1}).limit(t);if(o)throw console.error("Error fetching related content:",o),o;return r}static async incrementViewCount(e){try{const{error:t}=await n.from("content_items").update({view_count:n.sql`view_count + 1`,updated_at:new Date().toISOString()}).eq("id",e);t&&console.error("Error incrementing view count:",t)}catch(t){console.error("Error incrementing view count:",t)}}static async submitLeadMagnetRequest(e){const{error:t}=await n.from("website_demo_requests").insert({request_type:"lead_magnet",name:e.name,email:e.email,organization:e.organization,role:e.role,resource_id:e.resource_id,follow_up_requested:e.follow_up_requested,metadata:{source:"resources_page",timestamp:new Date().toISOString()}});if(t)throw console.error("Error submitting lead magnet request:",t),t}static async createContent(e){const{data:t,error:r}=await n.from("content_items").insert({...e,view_count:0}).select().single();if(r)throw console.error("Error creating content:",r),r;return t}static async updateContent(e,t){const{data:r,error:o}=await n.from("content_items").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(o)throw console.error("Error updating content:",o),o;return r}static async deleteContent(e){const{error:t}=await n.from("content_items").delete().eq("id",e);if(t)throw console.error("Error deleting content:",t),t}static generateSlug(e){return e.toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"")}static estimateReadingTime(e){const r=e.split(/\s+/).length;return Math.ceil(r/200)}static extractExcerpt(e,t=160){const r=e.replace(/#{1,6}\s/g,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/\[(.*?)\]\(.*?\)/g,"$1");return r.length<=t?r:r.substring(0,t).replace(/\s+\S*$/,"")+"..."}}export{i as C};
